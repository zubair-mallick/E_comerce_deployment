import{g as U,h as z,r as t,d as B,i as D,_ as n,j as s,f as H}from"./index-DKYrVGzK.js";import{S}from"./skeleton-BXcKBhrl.js";import{p as q}from"./product_card-PG7xoV3R.js";import"./features-B6z4mT7H.js";const R=()=>{const u=U()[0];console.log(u);const{data:i,isLoading:g,isError:f,error:x,isSuccess:p}=z(""),[a,v]=t.useState(""),[h,P]=t.useState(""),[c,C]=t.useState(0),[o,y]=t.useState(1e5),[l,E]=t.useState(T(u.get("category")||"")),[m,d]=t.useState(1),[N,b]=t.useState(!1),[k,L]=t.useState(!1),[_,w]=t.useState(a),F=B(),M=e=>{if(e.stock<1)return n.error("out of Stock");F(H(e))};function T(e){return String(e).charAt(0).toUpperCase()+String(e).slice(1)}const{data:r,isLoading:A,isError:Q,error:j}=D({search:_,sort:h,category:l,minPrice:c,price:o,page:m});return t.useEffect(()=>{const e=setTimeout(()=>{w(a)},500);return()=>clearTimeout(e)},[a]),t.useEffect(()=>{r&&(b(!r.isLastPage),L(!r.isFirstPage))},[r]),t.useEffect(()=>{Q&&n.error(j.data.message)},[j]),t.useEffect(()=>{p&&n.success(i.message,{position:"bottom-center"}),f&&n.error(x.data.message)},[x,p]),t.useEffect(()=>{d(1)},[a,h,c,o,l]),s.jsxs("div",{className:"product-search-page",children:[s.jsxs("aside",{children:[s.jsx("h2",{children:"Filters"}),g?s.jsx(S,{count:10,height:80/5+"%",width:200}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("h4",{children:"Sort"}),s.jsxs("select",{value:h,onChange:e=>{P(e.target.value)},children:[s.jsx("option",{value:"",children:"None"}),s.jsx("option",{value:"asc",children:"Price (low to high)"}),s.jsx("option",{value:"des",children:"Price (high to low)"})]})]}),s.jsxs("div",{children:[s.jsxs("h4",{children:["Min Price: ",c]}),s.jsx("input",{type:"range",min:0,max:1e5,value:c,onChange:e=>{C(Number(e.target.value))}})]}),s.jsxs("div",{children:[s.jsxs("h4",{children:["Max Price: ",o]}),s.jsx("input",{type:"range",min:0,max:1e5,value:o,onChange:e=>{y(Number(e.target.value))}})]}),s.jsxs("div",{children:[s.jsx("h4",{children:"Category"}),s.jsxs("select",{value:l,onChange:e=>{E(e.target.value)},children:[s.jsx("option",{value:"",children:"ALL"}),!g&&(i==null?void 0:i.categories.map(e=>s.jsx("option",{value:e,children:e.toUpperCase()},e)))]})]})]})]}),s.jsxs("main",{children:[s.jsx("h1",{children:"Products"}),s.jsx("input",{type:"text",placeholder:"Search By Name",value:a,onChange:e=>{v(e.target.value)}}),s.jsx("div",{className:"search-product-list",children:A?Array.from({length:8}).map((e,I)=>s.jsx(S,{height:200,width:300,className:"product-skeleton"},I)):r==null?void 0:r.products.map(e=>s.jsx(q,{productId:e._id,name:e.name,price:e.price,stock:e.stock,handler:M,photos:e.photos},e._id))}),s.jsxs("article",{children:[s.jsx("button",{disabled:!k,onClick:()=>d(e=>e-1),children:"Prev"}),s.jsx("span",{children:m}),s.jsx("button",{disabled:!N,onClick:()=>d(e=>e+1),children:"Next"})]})]})]})};export{R as default};
